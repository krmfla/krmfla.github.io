"use strict";Vue.component("lottery-fillin",{template:"#lotteryFillin",data:function(){return{type:"",mobile:"",userid:"",awardPaper:[{awardName:"現金 NT.99,999",path:"images/《能量不斷電終極大獎 現金99,999》中獎回覆函.doc"},{awardName:"Nintendo Switch",path:"images/《補充能量獎週週抽 Nintendo Switch》中獎回覆函.doc"},{awardName:"SONY PS4",path:"images/《百大鐵人排名獎 SONY PS4》中獎回覆函.doc"}],paper:null,fblogin:!1,fbData:{fbToken:"",fbId:"",fbName:"",fbPic:""},invNumber:"",awardItem:"",name:"",address:"",IdcardFront:null,IdcardBack:null,Bankbook:null,CertificatePhoto:null,agree:!1,imageShow:{IdcardFront:null,IdcardBack:null,Bankbook:null,CertificatePhoto:null}}},watch:{IdcardFront:function(){""==!this.IdcardFrontShow&&(document.querySelector("#frontpre p").style.display="none",document.querySelector("#frontpre img").style.opacity="1")},IdcardBack:function(){""==!this.IdcardBackShow&&(document.querySelector("#backpre p").style.display="none",document.querySelector("#backpre img").style.opacity="1")},Bankbook:function(){""==!this.BankbookShow&&(document.querySelector("#bankpre p").style.display="none",document.querySelector("#bankpre img").style.opacity="1")},CertificatePhotoShow:function(){""==!this.CertificatePhotoShow&&(document.querySelector("#certificatepre p").style.display="none",document.querySelector("#certificatepre img").style.opacity="1")}},methods:{readpoto:function(e){var t=this,a=e.target.files.item(0),n=e.target.id,e=new FileReader;e.addEventListener("load",function(e){"front"==n&&(t.imageShow.IdcardFront=e.target.result,t.IdcardFront=a);"back"==n&&(t.imageShow.IdcardBack=e.target.result,t.IdcardBack=a);"bank"==n&&(t.imageShow.Bankbook=e.target.result,t.Bankbook=a);"certificate"==n&&(t.imageShow.CertificatePhoto=e.target.result,t.CertificatePhoto=a)}),e.readAsDataURL(a)},postback:function(){var t=this;if(!t.loading)if(t.loading=!0,t.name)if(t.address){if("FB"==t.type){if(!t.fbData.fbId)return alert("請先登入FB"),void(t.loading=!1)}else if("Invoice"==t.type&&!t.CertificatePhoto)return alert("請上傳發票正本電子檔"),void(t.loading=!1);t.agree?t.grecaptcha("backfill").then(function(){t.postRecipientinfo().then(function(e){e.success?alert("資料已送出，感謝您的參與！"):alert("您並無資格領取此獎項。"),window.location.href="./index.html",t.loading=!1})}):(alert("請勾選我已詳閱"),t.loading=!1)}else alert("請填入地址"),t.loading=!1;else alert("請填入收件人"),t.loading=!1},postRecipientinfo:function(){var t=this;postInfo({name:t.name},"apiName").then(function(e){e.success?alert("資料已送出，感謝您的參與！"):alert("您並無資格領取此獎項。"),window.location.href="./index.html",t.loading=!1})},fbLogin:function(){var t=this;FB.login(function(e){"connected"===e.status&&(t.fbData.fbToken=e.authResponse.accessToken,t.fbData.fbId=e.authResponse.userID,FB.api("/me","GET",{fields:"id,name,picture"},function(e){t.fbData.fbName=e.name,t.fbData.fbPic="http://graph.facebook.com/"+e.id+"/picture?width=140&height=140",t.fblogin=!0}))})},getRecipientinfo:function(){var a=this;return new Promise(function(t){getInfo("","apiName"+a.userid).then(function(e){e.success?(a.mobile=e.data.mobile,a.invNumber=e.data.referenceInfo,a.awardItem=e.data.awardName,a.type=e.data.referenceType,t()):(alert("資料已回填或無法查獲此獎項"),window.location.href="./index.html")})})},checkPaper:function(){var t=this;t.awardPaper.forEach(function(e){if(t.awardItem==e.awardName)return t.paper=e})}},mounted:function(){var e=this;loadpage("init"),e.userid=findGetParameter("user"),e.getRecipientinfo().then(function(){e.checkPaper()})}});
//# sourceMappingURL=lotteryFillin.js.map
