"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var s=e[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var ProjectApi=function(){function a(t,e){_classCallCheck(this,a),this.baseReq,this.info,this.jwt,this.date,this.tokenId=t,this.webtoken=e,this.friendo_url=document.getElementById("appjs").dataset.site,this.init()}return _createClass(a,[{key:"init",value:function(){var e=this;this.baseReq=axios.create({baseURL:this.friendo_url,headers:{"Content-Type":"application/json"},dataType:"json",data:{}}),this.baseReq.interceptors.request.use(function(t){return t.headers.Authorization="Bearer "+e.jwt,t},function(t){return console.error(t),Promise.reject(t)}),this.baseReq.interceptors.response.use(function(t){return t.data},function(t){return console.error("res Error:",t),Promise.reject(t)})}},{key:"token",value:function(){var e=this;return axios.get("".concat(this.friendo_url,"token/").concat(this.tokenId),{headers:{webtoken:this.webtoken},dataType:"json"}).then(function(t){return e.jwt=t.data.token,e.info={startDate:t.data.startDate,endDate:t.data.endDate,status:t.data.projectStatus},e.checkPorject()})}},{key:"get",value:function(t,e,a){var s=this;return this.token().then(function(){return s.baseReq.get(t,e).catch(function(t){var e=t.response,t=a||"api_tag";logSystem(0,{api_url:e.config.url,request_data:JSON.stringify(e.config.data),statusText:e.statusText,message:e.data.message,httpStatus:e.status},t)})})}},{key:"post",value:function(t,e,a,s){var n=this;return this.token().then(function(){return n.baseReq.post(t,e,a).catch(function(t){var e=t.response,t=s||"api_tag";logSystem(0,{api_url:e.config.url,request_data:JSON.stringify(e.config.data),statusText:e.statusText,message:e.data.message,httpStatus:e.status},t)})})}},{key:"checkPorject",value:function(){switch(this.info.status){case 0:case 1:return Promise.reject();case 3:return alert("活動已結束"),Promise.reject();default:return Promise.resolve()}}}]),a}();