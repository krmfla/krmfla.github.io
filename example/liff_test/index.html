<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Liff test</title>
    <style>
        .result {
            width: 100%;
            word-break: break-all;
            padding: 10px;
            box-sizing: border-box;
        }
        button {
            min-width: 125px;
            margin: 5px 10px 10px;
            padding: 5px;
        }
    </style>
    <script src="https://static.line-scdn.net/liff/edge/versions/2.3.0/sdk.js"></script>
</head>

<body>
    <h1>LIFF test 11:38</h1>
    <p>分享前請先登入及初始化</p>
    <div id='result' class='result'></div>
    <button id='btn5'>登入</button>
    <button id='btn6'>登出</button>
    <button id='btn1'>初始化</button>
    <button id='btn3'>取得個人資料</button>
    <button id='btn4'>取得授權碼</button>
    <button id='btn2'>訊息分享</button>
    <button id='btn7'>圖文訊息分享</button>
    <button id='btn8'>按鈕式訊息分享</button>
    <button id='btn9'>動畫+按鈕訊息分享</button>
    <button id='btn10'>getContext</button>
    <script>
      var btn1 = document.getElementById('btn1');
      var btn2 = document.getElementById('btn2');
      var btn3 = document.getElementById('btn3');
      var btn4 = document.getElementById('btn4');
      var btn5 = document.getElementById('btn5');
      var btn6 = document.getElementById('btn6');
      var btn7 = document.getElementById('btn7');
      var btn8 = document.getElementById('btn8');
      var btn9 = document.getElementById('btn9');
      var btn10 = document.getElementById('btn10');
      var result = document.getElementById('result');
        
      window.onerror = function(err, xhr, message) {
        result.innerText = (err + ', ' + xhr + ', ' + message);
      }

      btn1.onclick = async function() {
        await liff.init({liffId: "1612283647-VQeR60d6"});
        if(liff.isLoggedIn()){
          alert('已在登入狀態');
        } else {
          alert('尚未登入');
        }
      }
      btn2.onclick = function() {
        liff.shareTargetPicker([
          {
            type: "text",
            text: "一緒にオラオラオラオラ\r\n💫💥🤛🤛🤛👊👊👊💥💫\r\nhttps://web.archive.org/web/20150407071659/http://jojogame.bngames.net/asb/"
          }
        ])
        .then(res => { 
            //alert(JSON.stringify(res)) 
        })
        .catch(function(err) {
          alert(JSON.stringify(err));
        });
      }
      btn3.onclick = function() {
        liff.getProfile()
            .then(data => {
              result.innerText = JSON.stringify(data);
            })
            .catch((err) => {
              result.innerText = JSON.stringify(err);
            });
      }
      btn4.onclick = function() {
        var token = liff.getAccessToken();
        result.innerText = JSON.stringify(token);
      }
      btn5.onclick = function() {
          liff.login();
          alert('已登入');
      }
      btn6.onclick = function() {
          liff.logout();
          alert('已登出');
      }
      btn7.onclick = function() {
          liff.shareTargetPicker([{
            type: "flex",
            altText: "好康分享~來NISSAN預約試乘，購車加送保修禮券3,000元喔！",
            contents: {
                type: "bubble",
                size: "kilo",
                hero: {
                    type: "image",
                    url: "https://krmfla.github.io/example/liff_test/flex_test2.png",
                    size: "full",
                    aspectRatio: "1:1",
                    aspectMode: "cover",
                    action: {
                        type: "uri",
                        uri: "https://line.me/R/ti/p/@nissan.tw"
                    }
                }
            }
          }]);
      }
        btn8.onclick = function() {
            liff.shareTargetPicker([{
              "type": "template",
              "altText": "能量大漲！新春運勢開紅盤，登錄發票抽10萬紅包",
              "template": {
                  "type": "buttons",
                  "thumbnailImageUrl": "https://campaign.friendo.com.tw/2021CBCNY/images/share.jpg",
                  "imageAspectRatio": "rectangle",
                  "imageSize": "cover",
                  "imageBackgroundColor": "#000000",
                  "title": "牛年大漲",
                  "text": "快來測試你的好手氣",
                  "defaultAction": {
                      "type": "uri",
                      "label": "測字去",
                      "uri": "https://campaign.friendo.com.tw/2021CBCNY/"
                  },
                  "actions": [
                      {
                        "type": "uri",
                        "label": "測字去",
                        "uri": "https://liff.line.me/1654902258-GYvepqEX"
                      },
                                {
                        "type": "uri",
                        "label": "看得獎公告",
                        "uri": "https://campaign.friendo.com.tw/2021CBCNY/awards.html"
                      }
                  ]
              }
            }]);
        }
        btn9.onclick = function() {
            liff.shareTargetPicker([
                {
                  "type": "flex",
                  "altText": "您有一張套餐兌換券尚未領取喔~",
                  "size": "kilo",
                  "contents": {
                    "type": "bubble",
                    "header": {
                      "type": "box",
                      "layout": "vertical",
                      "backgroundColor": "#FFFFFF",
                      "contents": [
                        {
                          "type": "text",
                          "text": "🦞🧡~龍蝦套餐兌換券~🧡🦞",
                          "gravity": "center",
                          "align": "center",
                          "size": "md",
                          "weight": "regular"
                        }
                      ]
                    },
                    "body": {
                      "type": "box",
                      "layout": "vertical",
                      "backgroundColor": "#f7b6c0",
                      "contents": [
                        {
                          "type": "image",
                          "url": "https://krmfla.github.io/images/ezgif.png",
                          "size": "lg",
                          "aspectMode": "cover",
                          "aspectRatio": "1:1.2",
                          "gravity": "center",
                          "animated": true
                        }
                      ],
                      "paddingAll": "0px"
                    },
                    "footer": {
                      "type": "box",
                      "layout": "vertical",
                      "contents": [
                        {
                          "type": "button",
                          "action": {
                            "type": "uri",
                            "label": "試試你的好手氣",
                            "uri": "https://showcase.friendo.com.tw/chamonixlovesea/"
                          },
                          "style": "primary"
                        },
                        {
                          "type": "button",
                          "action": {
                            "type": "uri",
                            "label": "前往粉絲團",
                            "uri": "https://www.facebook.com/chamonix.com.tw/"
                          },
                          "style": "link",
                          "color": "#ffac40"
                        }
                      ]
                    }
                  }
                }
            ])
        }
        btn10.onclick = function() {
            const context = liff.getContext();
            result.innerText = JSON.stringify(context);
        }
    </script>
</body>
</html>
