<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Liff test</title>
    <style>
        .result {
            width: 100%;
            word-break: break-all;
            padding: 10px;
            box-sizing: border-box;
        }
        button {
            margin: 5px 10px;
        }
    </style>
    <script src="https://static.line-scdn.net/liff/edge/versions/2.3.0/sdk.js"></script>
</head>

<body>
    <h1>Liff test 02:02</h1>
    <div id='result' class='result'></div>
    <button id='btn1'>INIT</button>
    <button id='btn2'>SHARE</button>
    <button id='btn3'>GET PROFILE</button>
    <button id='btn4'>GET ACCESS TOKEN</button>
    <button id='btn5'>LOGIN</button>
    <button id='btn6'>LOGOUT</button>
    <button id='btn7'>FLEX SHARE</button>
    
    <script>
      var btn1 = document.getElementById('btn1');
      var btn2 = document.getElementById('btn2');
      var btn3 = document.getElementById('btn3');
      var btn4 = document.getElementById('btn4');
      var btn5 = document.getElementById('btn5');
      var btn6 = document.getElementById('btn6');
      var btn7 = document.getElementById('btn7');
      var result = document.getElementById('result');
        
      window.onerror = function(err, xhr, message) {
        result.innerText = (err + ', ' + xhr + ', ' + message);
      }

      btn1.onclick = async function() {
        await liff.init({liffId: "1612283647-VQeR60d6"});
        if(liff.isLoggedIn()){
          alert('已在登入狀態');
        } else {
          alert('尚未登入');
        }
      }
      btn2.onclick = function() {
        liff.shareTargetPicker([
          {
            type: "text",
            text: "OLA-OLA-OLA-OLA"
          }
        ])
        .then(res => { alert(JSON.stringify(res)) })
        .catch(function(err) {
          alert(JSON.stringify(err));
        });
      }
      btn3.onclick = function() {
        liff.getProfile()
            .then(data => {
              result.innerText = JSON.stringify(data);
            })
            .catch((err) => {
              result.innerText = JSON.stringify(err);
            });
      }
      btn4.onclick = function() {
        var token = liff.getAccessToken();
        result.innerText = JSON.stringify(token);
      }
      btn5.onclick = function() {
          liff.login();
          alert('已登入');
      }
      btn6.onclick = function() {
          liff.logout();
          alert('已登出');
      }
      btn7.onclick = function() {
          liff.shareTargetPicker([{
            type: "flex",
            altText: "好康分享~來NISSAN預約試乘，購車加送保修禮券3,000元喔！",
            contents: {
                type: "bubble",
                size: "giga",
                hero: {
                    type: "image",
                    url: "http://krmfla.github.io/example/liff_test/flex_test.png",
                    size: "full",
                    aspectRatio: "1:1",
                    aspectMode: "cover",
                    action: {
                        type: "uri",
                        uri: "https://line.me/R/ti/p/%40nissan.tw"
                    }
                }
            }
        }]);
      }
    </script>
</body>
</html>
